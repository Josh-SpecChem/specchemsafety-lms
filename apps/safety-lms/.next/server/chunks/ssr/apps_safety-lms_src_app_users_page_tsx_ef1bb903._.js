module.exports=[83592,a=>{"use strict";a.s(["default",()=>H],83592);var b=a.i(11755),c=a.i(80150),d=a.i(849),e=a.i(81953),f=a.i(30495),g=a.i(18550),h=a.i(38608),i=a.i(17802),j=a.i(80511);let k=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{className:"relative w-full overflow-auto",children:(0,b.jsx)("table",{ref:d,className:(0,j.cn)("w-full caption-bottom text-sm",a),...c})}));k.displayName="Table";let l=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("thead",{ref:d,className:(0,j.cn)("[&_tr]:border-b",a),...c}));l.displayName="TableHeader";let m=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tbody",{ref:d,className:(0,j.cn)("[&_tr:last-child]:border-0",a),...c}));m.displayName="TableBody",c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tfoot",{ref:d,className:(0,j.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c})).displayName="TableFooter";let n=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("tr",{ref:d,className:(0,j.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...c}));n.displayName="TableRow";let o=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("th",{ref:d,className:(0,j.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));o.displayName="TableHead";let p=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("td",{ref:d,className:(0,j.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));p.displayName="TableCell",c.forwardRef(({className:a,...c},d)=>(0,b.jsx)("caption",{ref:d,className:(0,j.cn)("mt-4 text-sm text-muted-foreground",a),...c})).displayName="TableCaption";var q=a.i(13322),r=a.i(72803),s=a.i(62173),t=a.i(21211);let u=(0,t.default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var v=a.i(89499),w=a.i(36634),x=a.i(30699),y=a.i(43139),z=a.i(41120),A=a.i(52856);let B=(0,t.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),C=(0,t.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var D=a.i(8304),E=a.i(37100),F=a.i(59410),G=a.i(81160);function H(){let{users:a,loading:j,error:t}=function(){let[a,b]=(0,c.useState)([]),[d,e]=(0,c.useState)(!0),[f,g]=(0,c.useState)(null),h=(0,F.createClient)(),i=async()=>{try{e(!0),g(null);let{data:a,error:c}=await h.from("profiles").select(`
          id,
          first_name,
          last_name,
          email,
          job_title,
          role,
          status,
          plant_id,
          auth_user_id,
          created_at,
          updated_at,
          plants (
            id,
            name
          )
        `).order("created_at",{ascending:!1});if(c)throw c;let{data:d,error:f}=await h.auth.admin.listUsers();f&&console.warn("Could not fetch auth users:",f);let i=(a||[]).map(a=>{let b=d?.users?.find(b=>b.id===a.auth_user_id),c=Array.isArray(a.plants)?a.plants[0]?.name:a.plants?.name;return{id:a.id,first_name:a.first_name,last_name:a.last_name,email:a.email,job_title:a.job_title,role:a.role,status:a.status,plant_id:a.plant_id,plant_name:c,auth_user_id:a.auth_user_id,created_at:a.created_at,updated_at:a.updated_at,last_login_at:b?.last_sign_in_at,is_active:"active"===a.status}});b(i)}catch(a){console.error("Error fetching users:",a),g(a instanceof Error?a.message:"Failed to fetch users")}finally{e(!1)}};return(0,c.useEffect)(()=>{i()},[]),{users:a,loading:d,error:f,refetch:i}}(),{getPermissions:H}=(0,G.useUser)(),I=H(),[J,K]=c.useState(""),[L,M]=c.useState("all"),[N,O]=c.useState("all");if(j)return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"User Management"}),(0,b.jsx)("p",{className:"text-neutral-600 mt-2",children:"Manage users, roles, and permissions"})]})}),(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(E.Loader2,{className:"h-6 w-6 animate-spin text-primary-600"}),(0,b.jsx)("span",{className:"text-neutral-600",children:"Loading users..."})]})})]});if(t)return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"User Management"}),(0,b.jsx)("p",{className:"text-neutral-600 mt-2",children:"Manage users, roles, and permissions"})]})}),(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(A.XCircle,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900",children:"Error Loading Users"}),(0,b.jsx)("p",{className:"text-neutral-600 mb-4",children:t}),(0,b.jsx)(e.Button,{onClick:()=>window.location.reload(),children:"Try Again"})]})]});let P=a.filter(a=>{let b=a.first_name.toLowerCase().includes(J.toLowerCase())||a.last_name.toLowerCase().includes(J.toLowerCase())||a.email.toLowerCase().includes(J.toLowerCase()),c="all"===L||a.role===L,d="all"===N||"active"===N&&"active"===a.status||"inactive"===N&&"suspended"===a.status;return b&&c&&d});return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"User Management"}),(0,b.jsx)("p",{className:"text-neutral-600 mt-2",children:"Manage users, roles, and permissions"})]}),I?.canManageUsers&&(0,b.jsxs)(e.Button,{className:"flex items-center gap-2",children:[(0,b.jsx)(v.Plus,{className:"h-4 w-4"}),"Add User"]})]}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(d.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-neutral-600",children:"Total Users"}),(0,b.jsx)(w.Users,{className:"h-4 w-4 text-primary-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-neutral-900",children:a.length}),(0,b.jsx)("p",{className:"text-xs text-neutral-500",children:"All registered users"})]})]}),(0,b.jsxs)(d.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-neutral-600",children:"Active Users"}),(0,b.jsx)(z.CheckCircle,{className:"h-4 w-4 text-accent-green-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-neutral-900",children:a.filter(a=>"active"===a.status).length}),(0,b.jsx)("p",{className:"text-xs text-neutral-500",children:"Currently active"})]})]}),(0,b.jsxs)(d.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-neutral-600",children:"Administrators"}),(0,b.jsx)(y.Shield,{className:"h-4 w-4 text-red-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-neutral-900",children:a.filter(a=>"admin"===a.role).length}),(0,b.jsx)("p",{className:"text-xs text-neutral-500",children:"Admin users"})]})]}),(0,b.jsxs)(d.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-neutral-600",children:"Managers"}),(0,b.jsx)(x.Building2,{className:"h-4 w-4 text-blue-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-neutral-900",children:a.filter(a=>"safety_manager"===a.role||"plant_manager"===a.role).length}),(0,b.jsx)("p",{className:"text-xs text-neutral-500",children:"Manager users"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Search and Filter Users"}),(0,b.jsx)(d.CardDescription,{children:"Find specific users using search terms and filters"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(r.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-500"}),(0,b.jsx)(f.Input,{placeholder:"Search users...",value:J,onChange:a=>K(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(i.Select,{value:L,onValueChange:M,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-full sm:w-48",children:(0,b.jsx)(i.SelectValue,{placeholder:"Role"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Roles"}),(0,b.jsx)(i.SelectItem,{value:"admin",children:"Administrator"}),(0,b.jsx)(i.SelectItem,{value:"manager",children:"Manager"}),(0,b.jsx)(i.SelectItem,{value:"user",children:"User"})]})]}),(0,b.jsxs)(i.Select,{value:N,onValueChange:O,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-full sm:w-48",children:(0,b.jsx)(i.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(i.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(i.SelectItem,{value:"inactive",children:"Inactive"})]})]}),(0,b.jsxs)(e.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,b.jsx)(s.Filter,{className:"h-4 w-4"}),"More Filters"]})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Users"}),(0,b.jsxs)(d.CardDescription,{children:["Showing ",P.length," of ",a.length," users"]})]})})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(k,{children:[(0,b.jsx)(l,{children:(0,b.jsxs)(n,{children:[(0,b.jsx)(o,{children:"User"}),(0,b.jsx)(o,{children:"Role"}),(0,b.jsx)(o,{children:"Status"}),(0,b.jsx)(o,{children:"Plant"}),(0,b.jsx)(o,{children:"Last Login"}),(0,b.jsx)(o,{className:"w-[70px]"})]})}),(0,b.jsx)(m,{children:P.map(a=>{let c,d;return(0,b.jsxs)(n,{children:[(0,b.jsx)(p,{children:(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)(h.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(h.AvatarImage,{src:"",alt:`${a.first_name} ${a.last_name}`}),(0,b.jsx)(h.AvatarFallback,{className:"bg-gradient-to-r from-primary-500 to-secondary-500 text-white text-xs",children:(c=a.first_name,d=a.last_name,`${c.charAt(0)}${d.charAt(0)}`.toUpperCase())})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-medium text-neutral-900",children:[a.first_name," ",a.last_name]}),(0,b.jsx)("div",{className:"text-sm text-neutral-500",children:a.email})]})]})}),(0,b.jsx)(p,{children:(0,b.jsx)(g.Badge,{className:(a=>{switch(a){case"admin":return"bg-red-100 text-red-800";case"manager":return"bg-blue-100 text-blue-800";case"user":return"bg-green-100 text-green-800";default:return"bg-neutral-100 text-neutral-800"}})(a.role),children:a.role.charAt(0).toUpperCase()+a.role.slice(1)})}),(0,b.jsx)(p,{children:(0,b.jsx)(g.Badge,{className:"active"===a.status?"bg-accent-green-100 text-accent-green-800":"bg-neutral-100 text-neutral-800",children:"active"===a.status?"Active":"Suspended"})}),(0,b.jsx)(p,{className:"text-neutral-600",children:a.plant_name||"Not assigned"}),(0,b.jsx)(p,{className:"text-neutral-600",children:a.last_login_at?new Date(a.last_login_at).toLocaleDateString():"Never"}),(0,b.jsx)(p,{children:(0,b.jsxs)(q.DropdownMenu,{children:[(0,b.jsx)(q.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,b.jsx)(u,{className:"h-4 w-4"})})}),(0,b.jsxs)(q.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(q.DropdownMenuLabel,{children:"Actions"}),(0,b.jsxs)(q.DropdownMenuItem,{children:[(0,b.jsx)(D.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),I?.canManageUsers&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(q.DropdownMenuItem,{children:[(0,b.jsx)(B,{className:"mr-2 h-4 w-4"}),"Edit User"]}),(0,b.jsx)(q.DropdownMenuSeparator,{}),(0,b.jsxs)(q.DropdownMenuItem,{className:"text-red-600",children:[(0,b.jsx)(C,{className:"mr-2 h-4 w-4"}),"Delete User"]})]})]})]})})]},a.id)})})]})}),0===P.length&&(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(w.Users,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900",children:"No users found"}),(0,b.jsx)("p",{className:"text-neutral-600",children:"Try adjusting your search criteria or filters"})]})]})]})]})}}];

//# sourceMappingURL=apps_safety-lms_src_app_users_page_tsx_ef1bb903._.js.map